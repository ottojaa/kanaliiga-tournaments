<div class="container">
  <mat-card>
    <mat-progress-bar [ngClass]="loading ? 'show' : 'hide'" mode="indeterminate" color="accent"></mat-progress-bar>
    <mat-card-header>
      <mat-card-subtitle (click)="goBack()" style="display: flex; align-items: center; cursor: pointer;"
        ><mat-icon style="margin-right: 10px;">arrow_back</mat-icon>Go back</mat-card-subtitle
      >
    </mat-card-header>
    <ng-container *ngIf="teamInformation$ | async as team">
      <ng-container *ngIf="!noData; else showNoData">
        <mat-list>
          <section fxLayout="column" fxLayoutAlign="center center" class="mat-typography" style="text-align: left">
            <h3 class="mat-display-1" style="padding: 20px; font-weight: 100;">{{ team.teamInfo.name }}</h3>
          </section>
          <mat-grid-list cols="4" rowHeight="60px">
            <mat-grid-tile [colspan]="1" [rowspan]="1">
              <mat-form-field class="static-text">
                <mat-label>Wins</mat-label>
                <input matInput disabled value="{{ teamStats.faceoffWins }}" />
              </mat-form-field>
            </mat-grid-tile>
            <mat-grid-tile [colspan]="1" [rowspan]="1">
              <mat-form-field class="static-text">
                <mat-label>Losses</mat-label>
                <input matInput disabled value="{{ teamStats.faceoffLosses }}" />
              </mat-form-field>
            </mat-grid-tile>
            <mat-grid-tile [colspan]="1" [rowspan]="1">
              <mat-form-field class="static-text">
                <mat-label>Faceoffs played</mat-label>
                <input matInput disabled value="{{ teamStats.gamesPlayed }}" />
              </mat-form-field>
            </mat-grid-tile>
            <mat-grid-tile [colspan]="1" [rowspan]="1">
              <mat-form-field class="static-text">
                <mat-label>Win %</mat-label>
                <input matInput disabled value="{{ teamStats.winPercentage }} %" />
              </mat-form-field>
            </mat-grid-tile>
          </mat-grid-list>

          <div mat-subheader>Players</div>
          <ng-container *ngFor="let player of team.teamInfo.lineup">
            <div class="line">
              <hr class="between" />
            </div>
            <mat-list-item>
              <div class="row">
                <div class="col">
                  <div style="width: 6%; min-width: 50px;">
                    <img
                      class="rank-image"
                      *ngIf="validateRank(player.custom_fields.rank); else showUnranked"
                      matListAvatar
                      src="./assets/rank-icons/{{ player.custom_fields.rank }}.png"
                      alt="./assets/rank-icons/unranked-icon.png"
                    />
                    <ng-template #showUnranked>
                      <img
                        matListAvatar
                        src="./assets/rank-icons/unranked-icon.png"
                        alt="./assets/rank-icons/unranked-icon.png"
                      />
                    </ng-template>
                  </div>
                  <div style="width: 91%" mat-line>
                    <p class="player-name">{{ player.name }}</p>
                  </div>
                  <div style="width: 3%">
                    <ng-container *ngIf="validateSteamId(player.custom_fields.steam_id)">
                      <a href="https://steamcommunity.com/profiles/{{ player.custom_fields.steam_id }}" target="_blank"
                        ><img
                          matListAvatar
                          style="height: 25px; width: 25px;"
                          src="./assets/steam.png"
                          alt="./assets/rank-icons/unranked-icon.png"
                      /></a>
                    </ng-container>
                  </div>
                </div>
              </div>
            </mat-list-item>
            <mat-list-item style="margin: 15px 0 25px 0;">
              <app-stats-grid-list
                [playerId]="player.custom_fields.steam_id"
                [stats]="getPlayerStats(player.custom_fields.steam_id, team.teamStats)"
                style="width: 100%;"
              ></app-stats-grid-list>
            </mat-list-item>
          </ng-container>
          <mat-divider></mat-divider>

          <div mat-subheader>Latest matches</div>
          <mat-list-item *ngFor="let match of team.matches">
            <mat-icon mat-list-icon>history</mat-icon>
            <div mat-line>{{ match.participants[1].participant[0].name }}</div>
            <div mat-line>{{ match.date | date }}</div>
          </mat-list-item>
        </mat-list>
      </ng-container>

      <ng-template #showNoData>
        <div fxLayout="row" fxLayoutAlign="center center">
          <mat-icon color="warn">warning</mat-icon>
          <h3 style="margin-left: 10px;">No data found</h3>
        </div>
      </ng-template>
    </ng-container>
  </mat-card>
</div>
